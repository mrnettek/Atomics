REG.exe Command Guide with Examples

REG.exe is a command-line tool for reading, setting, deleting, and managing the Windows registry. Below is a detailed guide with syntax and examples for common operations.


1. Query Registry Keys and Values

[SYNTAX]
REG QUERY [ROOT\]RegKey /V ValueName [/s] [/F Data [/K] [/D] [/C] [/E]]
REG QUERY [ROOT\]RegKey /VE

[EXAMPLES]

Example 1: Query a specific value.
 REG QUERY HKLM\Software\Microsoft /V Version

Example 2: Query the default value of a key.
 REG QUERY HKCU\Environment /VE

Example 3: Search for a key containing specific data.
 REG QUERY HKLM\System /F "SystemDrive" /D /S


2. Add Registry Keys and Values

[SYNTAX]
REG ADD [ROOT\]RegKey /V ValueName [/T DataType] [/D Data] [/F]

[EXAMPLES]

Example 1: Add a string value.
 REG ADD HKCU\Environment /V TestValue /T REG_SZ /D "Test Data" /F

Example 2: Add a default value to a key.
 REG ADD HKCU\Environment /VE /D "Default Value" /F

Example 3: Add a DWORD value.
 REG ADD HKLM\Software\Example /V NumberValue /T REG_DWORD /D 1234 /F


3. Delete Registry Keys and Values

[SYNTAX]
REG DELETE [ROOT\]RegKey /V ValueName [/F]
REG DELETE [ROOT\]RegKey /VE [/F]
REG DELETE [ROOT\]RegKey /VA [/F]

[EXAMPLES]

Example 1: Delete a specific value.
 REG DELETE HKCU\Environment /V TestValue /F

Example 2: Delete the default value.
 REG DELETE HKCU\Environment /VE /F

Example 3: Delete all values under a key.
 REG DELETE HKCU\Environment /VA /F


4. Export and Import Registry Keys

[SYNTAX]
REG EXPORT [ROOT\]RegKey FileName.reg [/Y]
REG IMPORT FileName.reg

[EXAMPLES]

Example 1: Export a registry key.
 REG EXPORT HKCU\Environment Backup.reg /Y

Example 2: Import a registry key.
 REG IMPORT Backup.reg


5. Save and Restore Registry Hives

[SYNTAX]
REG SAVE [ROOT\]RegKey FileName.hiv [/Y]
REG RESTORE [ROOT\]RegKey FileName.hiv

[EXAMPLES]

Example 1: Save a registry key.
 REG SAVE HKLM\Software\Example Example.hiv /Y

Example 2: Restore a registry key.
 REG RESTORE HKLM\Software\Example Example.hiv


6. Copy Registry Keys

[SYNTAX]
REG COPY [\SourceMachine\][ROOT\]RegKey [\DestMachine\][ROOT\]RegKey

[EXAMPLES]
Example 1: Copy a key from one location to another.
 REG COPY HKCU\Environment HKLM\Software\Environment


7. Compare Registry Keys

[SYNTAX]
REG COMPARE [ROOT\]RegKey [ROOT\]RegKey [/V ValueName] [/s]

[EXAMPLES]

Example 1: Compare two keys.
 REG COMPARE HKCU\Environment HKLM\Environment

Example 2: Compare a specific value.
 REG COMPARE HKCU\Environment HKLM\Environment /V TestValue


8. Load and Unload Registry Keys

[SYNTAX]
REG LOAD KeyName FileName
REG UNLOAD KeyName

[EXAMPLES]

Example 1: Load a hive file.
 REG LOAD HKLM\TempHive TempFile.hiv

Example 2: Unload a hive file.
 REG UNLOAD HKLM\TempHive


9. Useful Switches
 /reg:32: Force 32-bit registry view.
 /reg:64: Force 64-bit registry view.
 /F: Force operation without prompt.
 /S: Include all subkeys.
 /E: Return exact matches only.


[NOTES]

Common Roots
 HKLM: HKEY_LOCAL_MACHINE
 HKCU: HKEY_CURRENT_USER
 HKCR: HKEY_CLASSES_ROOT
 HKU: HKEY_USERS
